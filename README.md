# Расширение «Ozon Price Tracker»

Это расширение для Google Chrome позволяет добавлять товары с маркетплейса [Ozon](https://www.ozon.ru/) в список отслеживания и автоматически узнавать об изменении их стоимости. Расширение показывает текущую, среднюю цену и величину скидки по каждому товару, а также уведомляет о снижении стоимости.

## Основные возможности

- Кнопка на странице любого товара Ozon, которая добавляет товар в отслеживание.
- Автоматическое получение цены с заданной периодичностью (по умолчанию — раз в час).
- Сохранение истории цен, вычисление средней стоимости и размера скидки.
- Всплывающие уведомления браузера при заметном снижении цены.
- Окно расширения (по нажатию на иконку), где видно список всех отслеживаемых товаров.
- Компактный график изменения цены у каждого товара прямо в окне расширения.
- Страница настроек, где можно выбрать, как часто проверять цены.
- Индивидуальные пороги цены для каждого товара: укажите значение, и браузер оповестит, когда цена опустится ниже него.

## Структура папки `extension`

```
extension/
├── background.js      # Сервис-воркер, выполняющий проверки цен и уведомления
├── contentScript.js   # Скрипт, который добавляет виджет на странице товара
├── contentStyles.css  # Оформление всплывающего виджета на странице товара
├── manifest.json      # Конфигурация Chrome Extension (Manifest v3)
├── options.html       # Страница настроек интервала
├── options.js         # Логика сохранения настроек
├── popup.html         # Разметка всплывающего окна расширения
├── popup.css          # Стили всплывающего окна
├── popup.js           # Управление списком отслеживаемых товаров
```

## Как установить расширение (подробно и «с нуля»)

Ниже приведена максимально подробная инструкция для людей без технического опыта. Следуйте шаг за шагом — всё получится.

1. **Подготовьте папку с расширением**
   1. Откройте папку проекта на компьютере. Если вы получили её в архиве, сначала распакуйте архив. Внутри должна быть папка `extension`.
   2. Убедитесь, что внутри `extension` есть файл `manifest.json` и другие файлы, перечисленные выше.

2. **Откройте Google Chrome**
   1. Запустите браузер Google Chrome (значок с красно-зелёно-жёлтым кругом и синей серединой).
   2. Проверьте, чтобы версия браузера была не слишком старой. Расширение рассчитано на Manifest v3, который поддерживают последние версии Chrome.

3. **Перейдите в раздел расширений**
   1. В правом верхнем углу Chrome нажмите на кнопку «⋮» (три точки).
   2. В выпадающем меню наведите курсор на пункт «Дополнительные инструменты».
   3. В появившемся подменю выберите пункт «Расширения». Откроется новая вкладка `chrome://extensions/`.

4. **Включите режим разработчика**
   1. В правом верхнем углу страницы «Расширения» найдите переключатель «Режим разработчика».
   2. Включите его — переключатель должен загореться синим цветом, а сверху появятся дополнительные кнопки.

5. **Загрузите наше расширение**
   1. Нажмите кнопку «Загрузить распакованное» (она появится после включения режима разработчика).
   2. Откроется окно выбора папки. Найдите папку проекта и внутри неё выберите папку `extension` (именно эту папку, без перехода внутрь неё).
   3. Нажмите кнопку «Выбрать папку» (или «Select Folder»). Chrome установит расширение и покажет его в списке.

6. **Закрепите иконку (по желанию)**
   1. В правом верхнем углу Chrome нажмите на значок «Расширения» (пазл).
   2. Найдите «Ozon Price Tracker» и нажмите на значок булавки, чтобы иконка закрепилась на панели браузера.

7. **Проверьте работу расширения**
   1. Перейдите на любую карточку товара на сайте Ozon.
   2. В правом нижнем углу появится аккуратная панель расширения. Нажмите «Добавить в отслеживание», чтобы товар попал в список.
   3. Кликните по иконке расширения в панели браузера — откроется окно со списком отслеживаемых товаров.

## Настройка интервала проверки цен

1. Откройте страницу настроек:
   - В появляющемся на товаре виджете нажмите ссылку «Настройки проверки», **или**
   - Нажмите на иконку расширения → кнопку ⚙ в правом верхнем углу всплывающего окна.
2. В поле «Интервал проверки (в минутах)» укажите желаемое значение. Минимально возможное — 5 минут.
3. Нажмите кнопку «Сохранить». Появится надпись «Настройки сохранены…». Теперь расширение будет автоматически использовать выбранный интервал.

## Как задать порог уведомления по цене

1. Нажмите на иконку расширения, чтобы открыть список отслеживаемых товаров.
2. У каждого товара появилось поле «Порог уведомления (₽)». Введите в него желаемую цену.
   - Чтобы очистить порог и получать только уведомления о снижении, оставьте поле пустым и просто нажмите Enter или переключитесь на другое поле.
3. После ввода значение сохранится автоматически. Под полем появится надпись «Уведомим при цене ≤ …», когда порог сохранён успешно.
4. При следующей автоматической проверке расширение пришлёт уведомление, если цена товара стала ниже указанного значения.

## Как читать график изменения цены

1. Откройте список отслеживаемых товаров (иконка расширения в панели браузера).
2. Под основной информацией каждого товара расположен светлый блок с мини-графиком.
3. Линия показывает, как менялась цена за последние обновления: чем выше точка, тем дороже была позиция.
4. Заштрихованная область под линией помогает быстро увидеть тренд. Последняя точка подсвечена — это текущая цена.
5. Под графиком есть подпись: количество последних обновлений и диапазон цен за этот период.
6. Если данных ещё недостаточно, появится подсказка «История цен появится после нескольких обновлений» — просто подождите, пока сервис-воркер соберёт больше точек.

## Полезные советы и ограничения

- Чтобы получать уведомления о снижении цены, убедитесь, что в Chrome разрешены уведомления для браузера и что вкладка с Ozon не заблокирована в фоновом режиме.
- Расширение хранит историю цен локально в вашем браузере. Если вы очистите данные браузера или переустановите расширение, история будет потеряна.
- Некоторые товары на Ozon могут загружаться нестандартным образом. Если цена не определяется автоматически, обновите страницу или повторно добавьте товар.
- Для корректной работы автоматических проверок держите Chrome запущенным. Сервис-воркер будет периодически обращаться к страницам товаров и обновлять историю цен.

## Как удалить расширение

1. Перейдите на страницу `chrome://extensions/` (как описано выше).
2. Найдите «Ozon Price Tracker» и выключите переключатель, чтобы временно остановить работу, либо нажмите «Удалить», чтобы полностью удалить расширение.
3. Если вы удаляете расширение окончательно, подтвердите действие в появившемся окне.

Если у вас возникнут трудности, повторите шаги или перезапустите браузер. Большинство проблем решается переустановкой расширения и повторным добавлением товара в отслеживание.
